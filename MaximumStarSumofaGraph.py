'''
-Medium-

*Priority Queue*

There is an undirected graph consisting of n nodes numbered from 0 to n - 1. You are given a 0-indexed integer array vals of length n where vals[i] denotes the value of the ith node.

You are also given a 2D integer array edges where edges[i] = [ai, bi] denotes that there exists an undirected edge connecting nodes ai and bi.

A star graph is a subgraph of the given graph having a center node containing 0 or more neighbors. In other words, it is a subset of edges of the given graph such that there exists a common node for all edges.

The image below shows star graphs with 3 and 4 neighbors respectively, centered at the blue node.


The star sum is the sum of the values of all the nodes present in the star graph.

Given an integer k, return the maximum star sum of a star graph containing at most k edges.

 

Example 1:


Input: vals = [1,2,3,4,10,-10,-20], edges = [[0,1],[1,2],[1,3],[3,4],[3,5],[3,6]], k = 2
Output: 16
Explanation: The above diagram represents the input graph.
The star graph with the maximum star sum is denoted by blue. It is centered at 3 and includes its neighbors 1 and 4.
It can be shown it is not possible to get a star graph with a sum greater than 16.
Example 2:

Input: vals = [-5], edges = [], k = 0
Output: -5
Explanation: There is only one possible star graph, which is node 0 itself.
Hence, we return -5.
 

Constraints:

n == vals.length
1 <= n <= 105
-104 <= vals[i] <= 104
0 <= edges.length <= min(n * (n - 1) / 2, 105)
edges[i].length == 2
0 <= ai, bi <= n - 1
ai != bi
0 <= k <= n - 1


'''
from typing import List
from collections import defaultdict
import heapq
class Solution:
    def maxStarSum(self, vals: List[int], edges: List[List[int]], k: int) -> int:
        G = defaultdict(list)
        n = len(vals)
        sums = [vals[i] for i in range(n)]
        for u,v in edges:
            if vals[v] > 0: 
                heapq.heappush(G[u], vals[v])
                sums[u] += vals[v]
                if len(G[u]) > k:
                    sums[u] -= heapq.heappop(G[u])
            if vals[u] > 0: 
                heapq.heappush(G[v], vals[u])
                sums[v] += vals[u]
                if len(G[v]) > k:
                    sums[v] -= heapq.heappop(G[v])
                            
        return max(sums)

 
        


if __name__ == "__main__":
    print(Solution().maxStarSum(vals = [1,2,3,4,10,-10,-20], edges = [[0,1],[1,2],[1,3],[3,4],[3,5],[3,6]], k = 2))
    print(Solution().maxStarSum(vals = [-5], edges = [], k = 0))

    vals = [-514,2094,-271,2178,-2409,332,618,179,2441,73,-1941,-1352,-223,939,575,430,1429,2020,-1911,-559,-1259,654,-1683,-20,2036,-1612,-59,-1503,748,-104,2353,-1618,1192,-1563,2024,1449,734,-534,-524,1993,1724,345,-1071,-267,-205,-54,-2252,953,2323,-1399]
    edges = [[44,18],[23,9],[6,36],[39,30],[22,24],[9,32],[15,48],[29,33],[30,5],[15,0],[7,21],[45,18],[7,11],[30,26],[40,35],[28,41],[13,22],[9,20],[42,43],[19,36],[12,2],[26,11],[33,12],[37,24],[7,15],[28,36],[32,0],[3,28],[14,16],[41,37],[26,27],[8,35],[40,19],[1,7],[36,27],[4,21],[36,22],[11,45],[18,32],[27,31],[8,36],[4,46],[8,0],[41,40],[18,5],[7,32],[0,40],[12,46],[1,23],[11,19],[42,17],[11,2],[34,16],[9,45],[32,39],[43,47],[17,29],[47,19],[4,19],[35,43],[10,18],[10,44],[35,38],[26,47],[29,46],[4,6],[14,36],[40,7],[8,22],[27,4],[0,30],[45,19],[13,31],[21,14],[11,18],[23,20],[9,25],[16,11],[35,6],[21,16],[12,31],[37,1],[14,0],[43,11],[38,49],[48,23],[8,13],[3,19],[19,5],[12,27],[30,21],[36,13],[7,26],[43,31],[31,25],[24,42],[40,20],[44,41],[44,46],[38,30],[20,41],[37,16],[17,1],[12,8],[8,27],[42,8],[12,40],[32,43],[16,0],[44,1],[31,44],[15,22],[27,33],[1,15],[41,43],[0,25],[22,46],[28,47],[30,20],[37,39],[4,47],[13,11],[2,24],[1,0],[46,5],[17,31],[17,43],[28,18],[45,25],[12,47],[10,20],[16,41],[44,26],[32,16],[27,23],[15,25],[45,32],[1,36],[39,12],[47,6],[41,42],[45,47],[41,46],[7,41],[43,10],[35,1],[10,29],[13,32],[30,24],[21,36],[10,15],[17,37],[21,24],[32,40],[21,43],[31,30],[5,45],[19,31],[22,27],[2,18],[6,23],[48,49],[31,4],[17,5],[19,25],[20,26],[39,11],[45,31],[8,31],[3,11],[30,3],[24,27],[4,29],[12,7],[28,22],[32,2],[31,34],[42,14],[34,17],[19,21],[44,42],[23,15],[7,27],[22,3],[4,1],[47,1],[9,34],[17,32],[27,25],[38,42],[31,3],[42,15],[12,16],[6,45],[38,6],[15,12],[1,43],[9,15],[1,19],[23,49],[37,38],[38,29],[41,34],[2,37],[42,25],[34,46],[43,37],[25,41],[7,28],[32,14],[24,13],[13,1],[14,8],[11,42],[49,6],[48,37],[9,29],[29,25],[30,2],[32,47],[3,23],[31,41],[22,45],[7,47],[17,4],[43,23],[18,8],[18,37],[48,34],[15,31],[2,13],[0,20],[10,17],[25,6],[43,28],[18,13],[19,14],[1,42],[47,35],[21,45],[29,15],[12,28],[31,1],[4,39],[36,48],[9,19],[3,29],[26,37],[36,3],[39,41],[21,49],[26,42],[22,34],[16,36],[4,5],[29,6],[30,13],[12,3],[18,0],[17,14],[18,19],[9,48],[39,6],[27,34],[42,33],[39,18],[38,5],[17,3],[36,18],[9,2],[29,41],[0,43],[2,27],[47,36],[19,27],[3,48],[7,31],[5,6],[17,49],[48,7],[48,44],[13,9],[26,6],[31,39],[33,32],[4,3],[14,5],[3,41],[8,23],[7,3],[1,34],[25,4],[20,7],[49,12],[30,47],[31,24],[1,49],[34,11],[17,39],[35,21],[13,0],[28,0],[42,28],[29,14],[30,49],[22,42],[15,28],[43,4],[4,24],[48,38],[0,21],[11,41],[49,27],[21,38],[47,5],[49,28],[35,18],[24,1],[47,27],[3,38],[5,9],[33,25],[1,5],[14,9],[11,35],[10,5],[1,46],[3,43],[27,38],[4,26],[26,5],[28,16],[0,29],[2,17],[7,4],[33,19],[0,44],[43,19],[0,19],[14,38],[24,0],[42,40],[37,28],[6,8],[28,30],[5,12],[31,11],[22,44],[1,25],[44,37],[32,6],[25,32],[41,32],[41,12],[3,6],[39,7],[6,42],[20,46],[20,18],[28,44],[27,15],[35,13],[22,21],[34,21],[19,8],[44,47],[6,15],[1,11],[45,10],[22,26],[36,0],[11,8],[20,27],[4,9],[27,6],[20,48],[12,9],[11,23],[20,6],[23,2],[12,26],[4,40],[6,9],[37,3],[30,29],[0,27],[39,36],[45,41],[22,19],[43,26],[37,25],[30,22],[30,33],[43,33],[19,49],[34,8],[23,42],[45,26],[20,22],[21,32],[26,49],[41,10],[16,27],[34,35],[9,28],[43,30],[19,39],[24,38],[25,43],[38,15],[43,18],[4,15],[34,38],[1,26],[19,24],[21,20],[43,34],[10,23],[33,17],[41,27],[44,8],[17,18],[25,17],[4,0],[0,41],[26,10],[26,18],[49,34],[32,38],[41,48],[34,2],[20,29],[4,28],[18,29],[28,27],[15,19],[35,12],[26,16],[39,5],[25,44],[26,3],[3,10],[23,7],[32,49],[49,43],[43,38],[14,43],[16,10],[20,42],[17,24],[25,40],[22,48],[26,41],[36,4],[8,45],[32,48],[43,48],[2,15],[11,36],[2,14],[37,20],[4,23],[39,10],[49,44],[36,32],[29,22],[28,40],[48,27],[33,44],[46,10],[49,31],[12,43],[27,39],[22,23],[16,47],[47,41],[30,48],[7,46],[36,42],[34,7],[33,15],[19,35],[38,45],[21,40],[26,36],[44,15],[13,15],[7,18],[24,15],[33,39],[19,17],[47,40],[36,40],[40,37],[32,46],[20,45],[15,43],[12,29],[22,17],[14,31],[9,27],[6,44],[9,8],[40,3],[30,25],[40,6],[49,8],[41,30],[15,47],[9,26],[39,0],[29,26],[20,13],[41,33],[2,44],[29,49],[38,44],[40,43],[13,25],[20,35],[29,2],[33,20],[25,36],[30,34],[5,34],[33,11],[40,23],[21,18],[49,16],[0,26],[7,29],[42,32],[27,45],[48,12],[1,27],[35,42],[15,3],[27,37],[47,39],[38,13],[25,5],[21,5],[41,23],[12,42],[4,2],[16,48],[21,1],[39,40],[9,49],[42,5],[36,37],[8,33],[19,2],[31,9],[17,11],[42,2],[1,33],[27,32],[47,9],[21,39],[43,45],[41,6],[43,36],[36,35],[8,15],[49,4],[35,4],[46,23],[42,3],[0,12],[0,38],[36,20],[11,32],[24,7],[32,37],[49,7],[3,2],[27,43],[23,19],[39,45],[5,0],[31,40],[0,33],[15,39],[5,32],[25,8],[11,12],[1,18],[22,5],[28,25],[7,25],[22,41],[41,49],[14,12],[4,30],[28,23],[15,18],[32,12],[49,40],[49,18],[27,5],[3,35],[31,2],[3,49],[6,33],[4,34],[21,42],[30,40],[2,39],[46,3],[23,18],[13,47],[17,16],[27,29],[32,3],[45,35],[49,37],[27,10],[6,2],[20,31],[3,44],[22,37],[17,7],[32,44],[6,11],[37,6],[10,25],[42,7],[1,45],[13,12],[21,15],[44,40],[7,13],[31,36],[44,9],[9,22],[28,31],[14,44],[17,35],[12,18],[36,44],[36,33],[41,36],[33,28],[11,30],[19,20],[12,23],[32,4],[22,38],[34,3],[31,48],[41,5],[46,49],[6,14],[8,21],[46,14],[37,35],[8,30],[28,5],[25,23],[7,10],[3,27],[43,2],[47,20],[44,39],[7,2],[32,34],[47,37],[27,30],[40,27],[24,5],[34,33],[40,33],[30,7],[22,43],[43,5],[46,38],[34,0],[13,4],[23,17],[5,15],[1,16],[26,25],[1,20],[23,35],[3,9],[49,11],[31,6],[29,21],[37,8],[36,49],[15,34],[45,29],[10,34],[19,37],[9,18],[13,41],[16,33],[31,37],[1,39],[45,40],[1,8],[21,47],[46,28],[23,16],[39,29],[28,48],[24,35],[27,44],[47,31],[6,7],[3,39],[37,11],[2,8],[12,1],[49,5],[12,21],[48,35],[9,42],[15,35],[14,11],[33,38],[2,10],[18,30],[12,10],[28,34],[9,38],[27,46],[1,41],[3,47],[46,45],[25,21],[23,5],[23,31],[4,33],[2,35],[25,11],[28,26],[36,38],[4,37],[38,8],[25,18],[3,5],[35,16],[11,48],[39,26],[41,17],[43,6],[14,34],[22,25],[39,14],[45,15],[48,29],[4,12],[37,29],[31,35],[20,44],[9,10],[24,41],[27,18],[13,14],[27,13],[39,46],[42,34],[44,5],[36,46],[2,48],[0,45],[38,28],[12,44],[12,20],[13,16],[29,11],[25,16],[32,23],[44,4],[42,4],[8,20],[39,42],[10,40],[17,12],[7,33],[32,10],[10,11],[43,20],[49,39],[4,10],[45,14],[32,22],[44,7],[48,6],[36,2],[11,15],[29,5],[10,13],[4,38],[36,15],[28,20],[48,17],[11,28],[9,1],[3,13],[24,36],[37,34],[21,23],[23,45],[49,35],[22,4],[40,24],[17,26],[10,38],[45,34],[17,21],[10,1],[43,29],[13,33],[5,35],[32,28],[6,34],[30,1],[14,23],[33,2],[25,47],[35,29],[0,17],[38,25],[6,19],[25,48],[25,24],[20,49],[5,37],[0,49],[43,44],[36,45],[5,8],[5,2],[13,26],[20,2],[45,13],[36,9],[18,38],[49,25],[8,7],[16,38],[35,0],[27,17],[28,13],[40,34],[24,11],[8,48],[14,10],[46,18],[10,0],[38,19],[35,27],[39,43],[23,34],[36,34],[22,14],[5,31],[12,22],[48,26],[9,40],[31,10],[48,13],[2,22],[17,30],[3,45],[17,28],[8,4],[4,11],[24,39],[43,46],[15,49],[7,38],[37,0],[35,26],[4,16],[18,41],[16,18],[16,31],[16,22],[43,16],[15,46],[10,19],[47,18],[42,31],[32,1],[18,4],[47,34],[44,34],[23,36],[2,40],[2,41],[15,14],[0,22],[44,35],[16,46],[37,46],[2,45],[40,46],[35,25],[10,37],[34,13],[23,37],[33,21],[4,41],[44,11],[6,0],[35,41],[45,16],[33,23],[43,9],[1,40],[26,21],[8,32],[5,48],[24,44],[25,46],[41,8],[48,47],[29,1],[41,14],[42,49],[15,16],[34,24],[42,30],[30,15],[34,39],[29,28],[2,25],[0,42],[41,21],[31,26],[36,29],[39,28],[11,46],[21,31],[38,26],[21,37],[8,10],[30,44],[18,22],[15,41],[1,6],[24,33],[35,28],[17,40],[14,1],[42,18],[21,48],[0,11],[33,22],[11,38],[21,9],[40,26],[42,27],[36,17],[40,13],[11,5],[6,10],[41,9],[0,3],[42,48],[39,48],[12,25],[38,1],[40,29],[8,43],[15,20],[41,19],[35,22],[27,14],[48,0],[25,3],[37,7],[12,37],[19,13],[39,13],[39,9],[9,46],[44,17],[19,30],[31,32],[26,15],[4,45],[24,14],[47,17],[26,33],[13,5],[49,47],[46,19],[37,13],[48,18],[31,18],[21,44],[10,48],[23,47],[32,15],[15,37],[37,42],[12,19],[18,40],[29,44],[34,18],[48,33],[46,8],[2,21],[30,32],[32,24],[19,34],[17,15],[24,12],[40,48],[18,14],[22,40],[42,19],[8,39],[36,10],[25,20],[1,48],[3,16],[7,36],[10,22],[0,2],[30,10],[17,46],[10,47],[23,26],[47,11],[26,19],[20,5],[29,32],[27,11],[17,13],[10,42],[16,30],[2,49],[20,11],[42,13],[35,30],[15,40],[20,16],[47,24],[43,7],[37,30],[21,3],[28,21],[5,16],[2,1],[33,9],[41,38],[5,36],[17,38],[35,10],[24,8],[7,35],[37,9],[22,49],[20,24],[48,24],[29,47],[8,28],[26,32],[31,22],[25,34],[47,42],[14,49],[29,23],[33,10],[29,34],[19,29],[30,9],[28,14],[42,16],[18,24],[18,3],[33,49],[2,16],[22,39],[7,19],[13,6],[13,29],[40,5],[0,46],[22,11],[42,46],[26,34],[45,30],[17,45],[2,46],[26,2],[19,28],[12,36],[45,24],[37,33],[39,35],[2,28],[23,39],[31,46],[48,45],[17,6],[46,24],[38,31],[4,14],[8,16],[46,21],[24,49],[33,45],[47,2],[47,38],[38,40],[30,6],[19,16],[14,40],[33,18],[21,10],[7,45],[6,21],[23,38],[23,44],[22,47],[8,17],[39,20],[48,46],[20,4],[43,24],[16,7],[30,36],[35,14]]
    k = 4
    print(Solution().maxStarSum(vals = vals, edges = edges, k = k))

        
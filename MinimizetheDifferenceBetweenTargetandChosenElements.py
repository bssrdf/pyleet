'''
-Medium-
*DP*

You are given an m x n integer matrix mat and an integer target.

Choose one integer from each row in the matrix such that the absolute 
difference between target and the sum of the chosen elements is minimized.

Return the minimum absolute difference.

The absolute difference between two numbers a and b is the absolute value of a - b.

 

Example 1:


Input: mat = [[1,2,3],[4,5,6],[7,8,9]], target = 13
Output: 0
Explanation: One possible choice is to:
- Choose 1 from the first row.
- Choose 5 from the second row.
- Choose 7 from the third row.
The sum of the chosen elements is 13, which equals the target, so the absolute difference is 0.
Example 2:


Input: mat = [[1],[2],[3]], target = 100
Output: 94
Explanation: The best possible choice is to:
- Choose 1 from the first row.
- Choose 2 from the second row.
- Choose 3 from the third row.
The sum of the chosen elements is 6, and the absolute difference is 94.
Example 3:


Input: mat = [[1,2,9,8,7]], target = 6
Output: 1
Explanation: The best choice is to choose 7 from the first row.
The absolute difference is 1.
 

Constraints:

m == mat.length
n == mat[i].length
1 <= m, n <= 70
1 <= mat[i][j] <= 70
1 <= target <= 800


'''
from functools import lru_cache
from typing import List

class Solution:
    def minimizeTheDifference(self, mat: List[List[int]], target: int) -> int:
        sums = set(mat[0])
        for i in range(1, len(mat)):
            newsum = set()
            for j in mat[i]: 
                for s in sums:
                    newsum.add(s+j)
            sums = newsum
        
        return min(abs(s-target) for s in sums)
    
    def minimizeTheDifference2(self, mat: List[List[int]], target: int) -> int:
        possible_min = sum(min(row) for row in mat)
        if possible_min > target: return possible_min - target
        
        nums = {0}
        for row in mat:
            nums = {x + i for x in row for i in nums if x + i <= 2*target - possible_min}
        
        return min(abs(target - x) for x in nums)
    
    def minimizeTheDifference3(self, mat: List[List[int]], target: int) -> int:
        m, n = len(mat), len(mat[0])
        ele = []
        dp = [[float('inf')]*(70*70+1) for _ in range(71)]
        def dfs(ele, i, sm):
            if i >= len(ele): return abs(sm-target)
            if dp[i][sm] == float('inf'):
                for s in ele[i]:
                    dp[i][sm] = min(dp[i][sm], dfs(ele, i+1, sm+s))
                    if dp[i][sm] == 0 or sm+s > target:
                        break
            return dp[i][sm]    
        for row in mat:
            ele.append(sorted(set(row)))
        return dfs(ele, 0, 0)
    
    def minimizeTheDifference4(self, mat: List[List[int]], target: int) -> int:
        ele = []
        @lru_cache(None)
        def dfs(i, sm):
            if i >= len(ele): return abs(sm-target)
            res = float('inf')
            for s in ele[i]:
                res = min(res, dfs(i+1, sm+s))
                if res == 0 or sm+s > target:
                    break
            return res
        for row in mat:
            ele.append(sorted(set(row)))
        return dfs(0, 0)
    
    def minimizeTheDifference5(self, mat: List[List[int]], target: int) -> int:
        possible = 1
        
        for row in mat:
            mask = 0
            for x in row:
                mask |= possible << x
                # So, possible keeps getting shifted to the left by x for x in row
                
            possible = mask
        
        d = 0
        while True:
            for t in (target - d, target + d):
                if t >= 0 and (possible >> t) & 1:
                    return d
            d += 1

    

        




if __name__ == "__main__":
    mat = [[1,2,3],
           [4,5,6],
           [7,8,9]]
    target = 13
    print(Solution().minimizeTheDifference(mat, target))
    mat = [[1,2,9,8,7]]; target = 6
    print(Solution().minimizeTheDifference(mat, target))
    mat = [[10,3,7,7,9,6,9,8,9,5],
           [1,1,6,8,6,7,7,9,3,9],
           [3,4,4,1,3,6,3,3,9,9],
           [6,9,9,3,8,7,9,6,10,6]]
    target = 5
    print(Solution().minimizeTheDifference(mat, target))
    print(Solution().minimizeTheDifference2(mat, target))
    mat = [[16,30,18,49,65,34,21,68,40,23,37,25,1,27,23,33,33,11,19,3,61,18,14,18,51,34,16,67,41,26,18,8,5,3,28,22,60,65,11,14,8,21,22,13,19,22,23,48,16,7,64,60,59,39,42,51,23,32,69,5,29,46,19,6,43,1,45,65,8,16],[9,45,58,54,52,12,42,46,15,26,6,26,29,2,38,28,7,57,64,45,24,31,63,28,30,32,53,31,37,17,8,24,64,36,33,46,32,56,51,70,35,19,40,68,59,59,64,8,41,67,43,3,46,8,66,45,31,30,48,66,30,27,55,44,22,35,14,58,58,29],[52,25,25,61,23,48,11,66,10,30,42,41,58,58,44,19,66,56,45,6,61,48,31,14,8,8,26,21,35,31,17,26,53,57,8,63,33,8,41,59,16,45,69,55,43,5,11,40,62,51,35,61,32,35,49,69,47,63,22,55,46,60,53,18,52,39,25,49,36,25],[1,47,65,39,69,6,46,22,10,27,1,69,23,53,11,51,54,34,56,62,14,52,26,38,55,52,38,53,49,37,45,34,7,15,55,25,50,27,1,47,42,32,65,35,39,19,35,14,4,25,20,3,70,3,9,58,16,47,52,59,63,9,54,64,36,36,3,3,29,41],[58,52,44,25,65,54,40,14,62,57,57,8,40,3,43,59,51,12,5,29,15,43,44,24,20,32,55,6,67,64,9,4,51,54,61,43,55,23,63,53,54,50,43,6,7,18,70,35,5,11,13,66,23,48,50,69,64,50,23,18,32,4,47,3,24,40,2,49,32,26],[61,62,36,54,10,48,59,60,53,44,31,18,12,52,14,3,62,59,43,38,70,28,61,26,18,45,67,69,11,4,26,5,25,1,19,18,54,22,17,68,51,56,14,10,37,24,29,63,65,22,3,21,27,17,67,52,23,46,24,64,55,33,9,3,20,45,24,3,11,29],[63,48,61,65,1,5,32,30,23,13,66,38,43,62,4,26,18,66,19,46,32,20,19,67,15,24,55,65,53,13,15,23,3,53,56,62,51,61,53,57,57,53,13,8,1,27,70,49,66,13,6,17,66,55,56,51,19,14,43,35,11,67,46,9,27,21,24,4,36,32],[21,20,70,1,55,21,21,37,26,63,39,13,33,3,7,1,44,24,32,49,20,14,8,31,18,59,27,59,63,47,26,5,42,11,50,9,15,65,25,37,16,35,17,49,21,68,66,39,43,36,27,5,2,32,61,57,39,58,15,31,49,46,56,62,51,11,34,44,4,17],[60,65,66,28,15,55,19,27,9,70,34,28,54,64,20,28,21,23,14,12,15,35,20,66,20,55,57,58,27,18,20,52,36,38,56,48,40,58,32,32,35,61,22,42,11,34,5,21,61,36,41,1,61,42,64,18,58,49,27,41,45,5,41,26,49,13,62,21,20,56],[64,11,11,49,41,39,14,27,27,37,68,7,2,59,12,33,30,34,2,35,15,22,59,13,39,20,66,45,61,19,36,53,48,35,15,53,33,35,35,2,67,16,27,12,13,33,2,49,37,42,31,49,47,50,3,40,29,61,5,4,54,45,35,21,15,26,11,30,49,29],[32,43,32,43,15,66,49,5,16,6,69,66,10,17,58,66,34,5,13,49,22,37,17,39,5,34,4,39,59,65,31,49,34,50,24,7,34,59,39,69,49,32,57,12,13,2,50,63,7,69,59,6,52,62,5,9,30,62,4,52,66,8,16,41,7,21,48,23,6,2],[55,8,36,3,11,54,2,45,35,25,32,16,24,44,67,48,38,42,10,1,68,54,4,10,66,34,34,53,22,2,9,65,26,62,24,56,68,43,22,24,40,36,51,3,7,27,2,15,38,35,64,32,5,57,34,56,40,66,1,32,41,28,47,12,7,2,45,37,20,15],[29,69,49,48,46,7,65,44,47,62,65,56,36,50,24,33,58,5,34,64,16,68,46,54,27,8,52,64,15,27,31,48,40,67,69,4,32,63,25,1,35,35,58,47,63,24,58,49,51,63,18,9,35,66,52,7,39,57,1,11,24,51,44,32,27,58,1,39,45,58],[34,18,64,20,4,20,22,56,18,19,68,27,16,25,18,7,57,37,15,31,58,69,6,51,67,41,16,56,28,56,67,37,45,43,15,7,23,41,29,2,6,61,30,69,22,63,20,44,2,70,46,64,39,64,23,23,13,11,12,58,49,15,27,33,34,43,17,38,10,34],[64,19,55,45,41,21,2,65,37,10,42,63,18,23,57,17,53,43,59,18,11,62,48,37,33,34,11,5,47,22,2,8,13,40,63,66,31,10,33,66,70,65,21,31,37,69,42,69,20,16,61,44,61,46,14,59,29,18,55,6,55,14,19,32,6,69,8,70,10,26],[53,61,21,55,41,18,16,28,13,43,23,67,30,24,66,3,64,5,6,42,19,20,69,24,14,56,2,46,48,31,65,64,34,68,20,68,65,36,42,63,30,61,26,64,34,6,23,28,58,40,7,65,15,2,45,24,33,47,3,60,28,51,48,51,5,60,13,44,35,1],[28,37,38,39,17,30,25,5,4,15,39,20,41,17,31,18,54,67,59,7,16,25,33,7,68,50,46,68,42,63,28,63,20,48,41,26,20,39,47,62,69,64,58,16,17,40,32,49,2,40,59,64,39,24,50,44,58,65,19,27,7,39,64,26,59,51,40,45,66,7],[40,67,33,5,46,36,28,23,51,54,39,67,17,47,4,45,61,65,32,18,18,27,26,30,55,61,12,64,44,33,2,41,9,25,32,46,14,65,40,35,57,32,68,65,68,61,56,22,20,40,48,15,70,14,30,57,44,40,18,9,15,39,5,7,9,64,14,33,6,55],[64,42,8,8,68,37,54,17,33,61,3,57,29,23,41,22,53,57,1,64,48,38,25,64,68,23,52,30,9,27,45,64,31,51,66,23,6,55,43,15,66,68,61,51,15,16,3,43,70,16,8,50,46,13,64,37,16,16,65,63,7,2,67,22,42,25,25,41,58,37],[56,50,16,40,36,27,27,34,38,4,65,17,10,43,62,37,55,57,1,26,15,22,60,27,21,20,37,62,36,58,47,1,63,66,58,43,21,55,21,49,5,10,4,67,67,38,28,13,56,69,1,39,14,40,19,55,51,35,5,60,67,70,67,60,3,57,70,67,36,37],[34,10,62,56,16,6,12,59,48,29,51,29,66,69,15,45,27,50,55,12,5,44,60,40,6,17,49,52,34,10,18,41,42,66,69,22,3,49,41,47,30,30,54,29,1,69,45,2,43,27,12,3,50,43,51,25,46,26,28,7,59,37,16,20,32,46,63,59,18,22],[58,32,24,70,6,48,61,69,11,10,45,57,66,54,18,5,18,52,43,60,34,50,17,12,13,9,7,31,70,63,48,29,33,32,51,3,57,34,59,3,28,9,67,16,32,56,56,70,54,26,7,56,26,18,53,41,6,10,11,29,61,43,55,49,18,23,53,43,2,65],[43,34,46,55,31,51,67,69,47,8,26,60,3,13,27,18,7,8,4,26,24,20,28,70,8,36,65,63,19,23,6,6,40,61,32,53,58,39,39,16,41,31,41,36,34,62,58,45,12,12,64,52,10,42,19,36,43,9,35,1,64,52,41,63,24,63,25,28,3,61],[30,42,59,5,56,28,16,41,54,11,10,45,36,55,36,11,38,30,21,54,6,70,33,70,61,8,37,34,50,45,25,62,20,31,34,34,64,38,63,64,19,48,25,20,39,63,58,40,69,32,43,56,59,4,46,55,3,67,55,23,23,54,43,2,70,53,14,46,52,31],[52,12,3,23,42,37,50,65,3,62,58,64,31,16,31,11,4,25,37,69,49,26,6,70,18,8,45,42,35,37,66,62,5,66,23,50,61,12,22,8,40,13,57,6,41,64,52,19,50,28,23,68,3,27,4,39,18,24,52,22,16,64,21,39,45,18,56,43,70,35],[18,37,62,68,27,29,43,44,60,11,39,12,70,2,30,65,7,23,53,15,48,60,23,37,57,42,19,41,49,5,39,62,15,17,24,61,36,17,45,40,2,9,61,48,60,6,47,40,35,48,31,68,16,9,29,34,66,21,61,35,19,48,60,20,19,48,36,46,14,56],[42,44,54,68,44,70,51,37,23,8,46,41,70,70,40,45,50,62,39,68,39,44,7,23,9,57,32,10,65,65,17,69,26,30,53,70,35,62,48,2,40,49,48,15,61,8,15,69,33,7,38,70,19,39,21,58,27,62,6,10,42,26,19,22,50,26,26,57,69,48],[34,6,35,51,31,18,3,59,70,21,48,63,3,36,58,56,54,54,29,5,9,48,29,70,24,37,10,41,17,33,45,55,46,63,37,26,1,56,24,35,50,8,15,5,23,40,9,11,8,16,39,37,24,63,10,53,53,3,53,60,18,51,55,60,64,63,41,50,3,3],[26,19,12,27,5,34,2,44,9,48,48,28,60,45,8,54,36,55,13,38,57,22,57,25,56,3,62,57,54,55,27,15,25,56,58,41,37,39,22,4,38,22,36,67,52,11,8,4,31,34,3,18,70,8,67,70,52,3,70,25,38,55,49,68,52,39,50,56,67,44],[12,33,39,28,34,25,21,25,65,67,8,21,12,33,33,8,41,31,63,62,70,27,16,69,17,53,24,58,58,19,38,68,24,22,62,27,7,13,54,30,46,7,50,47,26,9,29,50,16,61,64,32,9,31,51,35,69,3,11,33,30,38,68,12,7,42,36,40,4,24],[8,28,69,42,2,43,4,29,40,29,50,14,34,25,58,17,51,56,18,2,58,57,61,28,41,38,15,53,49,25,9,33,63,68,39,6,30,47,22,49,14,31,18,23,38,5,10,68,46,18,42,40,34,46,10,1,10,39,19,8,21,44,54,62,12,64,44,8,49,18],[35,66,70,65,9,67,63,15,5,17,22,56,14,7,65,39,17,23,53,37,57,62,29,46,62,52,40,11,34,19,42,22,30,4,4,30,24,47,4,49,40,7,2,4,59,52,42,62,50,54,7,16,60,23,17,24,57,48,29,3,58,31,16,4,64,69,64,29,41,15],[8,32,53,60,55,5,17,5,23,31,70,52,36,6,53,4,24,51,27,39,24,47,38,66,52,47,12,26,57,56,3,11,64,40,35,66,60,44,18,20,28,40,25,2,23,59,63,21,1,15,35,26,8,19,64,46,46,68,26,54,13,5,68,43,39,25,48,11,20,25],[15,10,46,12,70,60,29,64,68,68,58,47,36,21,34,45,61,25,59,45,69,65,33,21,26,44,49,63,57,56,17,64,35,43,2,50,2,27,49,8,39,1,64,36,57,26,21,15,25,12,34,20,27,2,62,66,52,49,8,40,43,13,63,66,47,48,58,50,9,23],[25,46,18,50,68,4,14,3,22,7,50,47,11,28,7,64,63,19,54,57,33,67,33,64,30,47,28,20,41,32,3,6,62,28,23,39,30,66,15,60,53,15,43,44,44,17,4,57,37,56,11,70,46,54,58,3,10,46,5,6,39,64,61,53,27,58,15,66,48,23],[4,10,21,62,57,13,24,40,65,17,27,13,40,8,6,28,6,63,12,29,40,9,35,30,54,33,3,59,56,69,65,29,4,12,11,14,9,63,65,46,20,61,53,49,31,49,53,46,60,37,19,2,16,5,36,59,66,12,7,51,63,31,62,56,28,9,31,64,67,42],[7,49,57,18,53,28,55,6,6,6,28,47,4,61,57,29,39,32,40,37,19,45,30,43,54,63,58,23,68,55,32,61,21,30,37,37,7,23,60,40,65,61,28,23,11,22,48,7,56,69,58,11,13,38,17,60,52,44,38,23,2,9,50,22,61,18,69,56,1,51],[42,11,8,40,37,62,49,25,47,31,14,31,19,6,60,13,26,65,11,42,68,61,55,39,34,35,29,39,44,36,69,26,38,60,35,17,18,42,50,39,35,68,21,45,17,30,10,69,57,1,51,3,39,2,33,14,40,64,60,11,34,60,68,13,25,58,2,60,16,55],[60,41,59,16,3,24,60,27,28,17,56,69,54,38,15,12,59,25,46,19,29,32,7,20,11,2,14,44,46,32,48,49,4,23,27,58,2,45,36,44,5,49,21,33,26,39,5,12,56,39,60,23,14,63,2,64,12,45,40,30,21,52,54,16,18,36,60,34,3,61],[17,53,36,62,52,7,10,2,69,28,49,37,55,9,52,7,60,11,4,19,62,11,42,2,65,27,22,50,30,40,66,41,56,16,35,22,51,22,11,37,26,7,3,52,27,59,50,3,62,15,19,48,53,9,51,54,45,49,34,67,65,8,37,43,67,34,35,51,44,48],[35,11,5,31,11,69,14,23,16,42,49,15,35,67,68,42,18,54,51,21,28,41,7,6,16,64,40,28,49,22,31,19,53,48,6,53,16,41,48,47,56,12,18,63,50,12,19,49,49,20,43,63,54,44,41,47,1,61,53,68,48,22,23,24,15,37,22,4,17,62],[2,20,66,23,32,42,64,25,26,13,16,68,52,6,58,70,60,57,12,10,33,67,30,41,25,12,68,55,9,25,28,68,4,2,51,67,48,2,26,39,29,49,18,48,39,20,45,12,32,39,33,11,26,8,69,13,28,41,45,51,61,3,56,46,27,61,61,44,45,15],[11,43,2,16,19,58,69,43,27,65,18,2,53,18,44,20,48,60,29,25,58,20,37,9,30,69,19,32,48,45,13,68,52,47,56,55,70,4,39,7,67,18,37,27,59,28,44,5,4,2,41,47,67,34,18,67,19,63,39,18,31,52,42,10,34,11,18,55,49,36],[31,39,35,51,30,37,16,24,41,8,58,23,29,36,10,60,55,26,13,30,21,31,38,46,25,18,27,24,53,22,60,52,59,9,31,25,61,46,45,20,46,68,52,44,7,9,14,22,21,30,17,61,10,35,64,66,65,9,57,7,67,13,52,65,39,27,26,27,17,53],[6,66,1,9,54,63,30,61,45,20,42,67,35,38,64,61,12,63,60,5,14,18,38,34,51,65,15,66,5,45,16,37,68,50,21,11,37,17,20,8,9,58,66,5,41,59,24,36,25,17,19,63,58,48,5,36,42,45,46,17,43,51,59,52,31,59,35,18,51,7],[36,45,32,18,29,53,30,22,37,70,27,50,58,11,28,43,33,32,24,63,6,28,19,34,30,37,52,61,18,18,23,44,11,59,5,31,63,62,37,32,57,55,38,35,4,51,18,22,15,59,14,17,57,68,56,2,40,22,16,22,70,32,12,32,37,54,42,4,47,31],[43,18,66,41,46,9,26,12,17,35,51,5,59,42,37,48,51,49,57,28,25,28,26,33,11,59,15,25,49,56,29,53,5,8,19,27,22,30,46,41,7,10,10,7,69,41,14,70,13,54,18,70,63,7,25,14,64,58,11,10,14,46,23,63,15,16,35,16,23,29],[12,66,40,50,14,63,64,13,58,51,61,30,2,50,54,30,8,27,59,2,17,70,40,50,22,27,61,51,23,35,47,60,42,7,66,44,5,34,9,36,41,62,20,61,9,27,42,60,53,57,58,43,50,30,67,69,54,6,24,53,25,58,43,30,19,35,56,48,44,56],[1,20,7,40,19,4,48,65,18,3,17,69,68,36,37,51,36,54,51,55,31,6,60,50,51,23,12,38,49,49,41,37,38,67,38,48,20,15,9,38,26,66,1,54,27,34,2,55,36,58,57,68,5,9,16,17,16,48,32,68,68,5,12,66,16,60,44,56,59,8],[37,43,58,4,3,3,1,33,50,35,17,61,48,19,44,26,63,30,16,39,16,27,11,3,34,50,65,39,58,26,52,17,46,21,54,18,69,9,69,18,36,35,28,41,25,22,62,48,33,51,55,42,70,3,36,34,56,6,41,11,45,47,69,48,58,5,35,27,47,5],[15,65,3,56,7,44,62,26,49,51,37,47,20,70,9,69,59,68,63,41,63,51,30,57,8,7,29,4,45,37,23,17,7,55,25,4,64,43,62,12,25,12,1,23,28,29,56,39,27,47,53,67,20,8,24,49,42,3,65,6,53,33,16,29,51,36,62,10,10,9],[13,8,16,19,64,24,18,20,34,9,44,17,54,14,32,29,69,69,61,54,58,51,18,14,52,43,43,46,9,67,48,65,5,11,6,30,69,8,57,47,37,64,55,62,12,15,8,70,16,32,3,49,12,6,45,13,62,67,39,45,46,64,40,21,40,33,49,23,40,64],[13,22,52,68,2,12,39,53,51,6,7,18,29,41,69,43,49,33,26,60,13,69,8,14,10,60,36,48,6,10,1,20,28,12,47,59,32,68,1,56,5,19,25,28,26,22,61,26,41,46,1,16,4,32,45,16,61,20,57,69,17,20,60,14,14,3,50,48,10,67],[43,45,4,56,63,25,65,48,51,23,4,65,70,42,4,25,18,6,53,35,41,24,12,21,6,13,62,66,19,32,34,19,19,69,23,39,2,34,14,9,5,7,69,66,67,16,3,55,20,4,65,22,46,16,70,65,15,34,49,55,25,57,53,5,46,46,55,29,22,25],[64,37,29,36,53,22,1,62,51,19,55,1,54,36,53,1,64,36,50,51,26,11,58,69,32,3,44,3,70,21,6,31,56,7,69,18,46,41,63,15,64,66,34,9,11,40,5,32,19,13,33,55,29,11,39,66,69,65,4,14,12,30,66,17,48,69,63,60,33,8],[49,49,6,15,56,35,25,51,38,45,7,52,21,8,51,66,34,28,16,51,20,54,18,61,23,68,39,29,48,70,48,58,70,15,26,35,6,69,70,29,38,31,51,4,19,2,35,31,24,56,17,56,30,3,46,5,67,19,14,13,11,48,15,64,30,3,36,36,15,13],[6,45,36,2,51,45,65,33,53,30,60,36,4,29,62,15,41,4,2,39,58,48,9,64,50,18,19,65,12,22,2,19,11,10,51,4,35,44,66,2,4,40,27,41,1,54,56,50,64,11,46,40,27,32,35,4,25,39,21,5,56,24,25,25,38,6,20,49,18,5],[67,58,25,54,53,32,32,62,55,18,8,20,50,24,23,21,2,61,51,70,57,22,64,26,53,22,69,14,15,36,32,39,48,69,41,21,50,67,13,19,17,57,4,56,31,45,49,10,32,38,67,34,41,67,20,41,29,56,37,33,37,29,35,6,58,65,43,20,18,27],[64,6,65,67,28,52,18,57,28,36,58,38,65,42,12,39,32,11,57,45,16,60,14,62,33,42,13,30,6,22,21,28,63,36,40,26,66,48,12,42,57,39,70,47,41,12,68,29,47,10,2,50,19,22,16,49,13,2,55,39,65,63,47,48,28,30,34,66,38,60],[32,6,3,51,40,20,70,70,34,3,11,29,32,43,57,37,24,33,57,38,37,12,15,53,26,58,26,17,34,26,37,24,36,66,31,70,47,58,11,44,2,61,5,66,35,32,34,42,39,24,51,26,59,60,47,65,15,27,53,38,66,49,61,25,37,31,68,12,31,38],[35,22,1,13,23,19,6,70,48,15,30,33,59,26,50,66,12,48,57,58,52,19,64,35,7,68,30,25,20,56,24,27,53,57,3,24,17,63,20,24,59,44,56,3,63,49,67,45,70,65,70,41,5,45,38,1,51,46,56,70,55,1,69,8,38,10,51,46,24,68],[4,23,19,36,45,49,58,45,34,41,59,54,26,11,23,11,3,62,47,55,37,54,10,26,65,4,65,63,62,70,5,55,49,15,60,40,67,58,63,16,61,33,18,30,37,1,49,66,15,68,50,67,11,37,23,7,40,58,10,39,11,8,34,38,70,24,13,26,69,19],[36,18,22,66,18,67,26,25,59,9,38,51,15,69,10,59,7,44,9,7,60,33,70,46,4,40,7,7,29,60,49,55,30,47,26,66,18,52,2,67,34,7,13,20,32,52,55,5,35,60,45,42,49,25,19,21,39,11,6,56,64,2,5,1,38,42,45,25,47,13],[52,63,31,23,38,59,46,28,24,5,49,61,42,52,60,8,5,13,65,60,31,39,11,52,58,51,25,67,27,50,54,28,36,41,34,50,51,45,44,46,19,6,32,9,13,56,64,9,21,24,7,18,46,19,49,27,36,33,65,60,30,50,29,69,41,34,39,69,53,62],[48,3,11,7,58,38,50,5,38,68,25,7,31,8,57,2,40,36,68,52,33,33,32,42,19,30,23,35,52,32,70,15,24,69,35,20,50,29,22,30,5,11,31,38,67,6,1,14,50,49,8,37,21,24,19,39,43,23,5,14,9,56,28,61,22,45,46,18,17,44],[30,22,54,26,44,60,42,52,16,36,15,22,3,70,37,51,12,31,59,30,27,51,70,59,65,53,65,48,45,3,19,26,45,48,39,13,28,64,52,5,34,36,59,66,27,23,29,5,35,16,45,44,44,67,56,66,64,62,40,69,56,7,43,70,34,44,51,42,15,16],[20,37,34,19,25,63,32,38,14,64,16,9,9,3,68,20,66,37,66,56,10,22,52,42,25,46,38,46,28,32,64,32,16,22,63,37,64,30,27,7,12,41,28,68,9,17,6,26,1,56,65,40,45,4,62,56,4,68,52,12,68,60,68,69,15,2,62,34,36,43],[62,45,68,42,46,15,65,62,42,35,40,31,6,59,64,63,42,48,5,66,6,27,58,18,13,48,29,4,9,20,34,16,46,31,63,11,59,32,17,48,69,32,11,12,41,22,10,47,62,20,55,61,13,45,47,55,9,37,47,42,47,17,69,12,44,15,54,23,3,47],[54,37,9,61,12,67,35,16,57,51,42,27,65,32,65,62,16,31,4,70,23,22,5,13,43,27,33,61,6,21,34,69,66,21,9,57,59,37,18,23,48,35,6,31,20,3,55,39,55,18,50,60,69,14,29,41,50,24,36,64,27,57,63,4,30,65,32,8,19,34],[32,14,15,48,8,56,21,6,68,69,44,28,43,30,15,70,13,64,47,66,7,9,67,36,44,64,5,8,50,12,25,25,12,18,13,65,20,45,51,39,15,24,12,30,43,62,42,58,49,37,36,26,67,64,55,39,69,18,56,45,19,55,20,8,25,21,1,21,18,61]]
    target = 727
    print(Solution().minimizeTheDifference(mat, target))
    print(Solution().minimizeTheDifference2(mat, target))
    mat = [[34,27,41,28,39,21,10,42,26,50,32,7,34,22,15,48,35,9,39,17,41,2,26,13,7,21,39,10,50,3,14,15,29,15,49,13,18,20],[3,1,49,50,16,14,32,25,27,30,16,41,33,44,44,3,39,10,47,4,22,47,33,11,18,40,45,9,24,30,21,34,22,41,33,29,49,23],[12,23,20,24,38,26,47,8,1,40,14,4,35,3,11,26,34,14,34,28,18,23,32,26,13,25,25,20,49,37,2,50,23,10,16,42,28,10],[12,48,33,10,39,36,32,19,41,1,41,23,13,45,31,44,49,42,37,4,25,35,34,33,36,29,37,9,20,15,20,35,20,3,13,4,13,8],[3,40,41,6,1,23,16,47,17,27,43,20,5,29,47,47,34,14,9,5,47,43,40,14,35,8,11,18,10,25,30,22,45,39,26,34,22,48],[29,10,45,34,3,36,21,13,2,9,42,23,4,45,4,20,4,3,47,32,36,39,28,11,8,38,3,32,20,3,34,39,24,1,11,9,47,1],[41,49,45,30,19,23,41,34,12,5,42,42,44,1,3,15,7,23,25,24,25,24,5,6,41,37,26,11,9,10,37,43,19,44,10,4,9,17],[42,24,27,21,23,28,34,25,27,48,48,25,23,39,8,15,6,34,1,15,36,9,5,50,45,12,2,4,35,22,17,44,44,14,6,7,29,7],[13,47,23,24,14,3,21,16,38,22,34,46,41,23,42,1,33,33,22,39,1,37,34,33,8,2,41,13,33,3,45,15,47,27,8,14,36,37],[48,12,33,46,3,24,7,35,37,32,10,36,19,35,3,48,15,1,19,33,14,12,22,28,18,25,39,12,10,39,43,8,4,46,2,48,5,18],[23,20,10,47,27,14,25,15,15,17,20,27,24,37,16,48,21,34,42,41,17,8,50,18,21,20,47,32,11,18,18,49,29,23,21,39,10,23],[28,12,5,11,5,45,50,16,21,6,11,19,8,27,9,18,39,19,3,5,17,19,26,26,7,7,30,35,11,50,36,1,4,40,9,21,46,16],[4,36,32,5,5,6,31,35,38,40,35,35,25,43,14,38,1,22,37,22,38,25,15,22,15,4,5,4,39,8,20,8,14,21,14,4,25,22],[5,35,33,28,45,18,8,7,22,9,20,43,22,18,10,29,32,22,25,31,24,42,29,21,28,43,30,46,40,34,36,48,22,40,24,19,32,48],[24,11,21,22,27,9,1,17,21,7,19,35,26,19,7,41,7,7,15,27,41,15,37,4,34,40,2,29,44,44,16,46,4,10,35,31,32,9],[21,18,27,31,24,39,16,27,22,3,5,42,32,7,20,34,49,9,10,40,20,38,22,28,18,9,39,37,29,35,17,48,26,7,4,38,14,15],[41,14,48,4,39,23,40,6,21,24,34,49,42,25,44,27,45,6,39,37,48,3,17,19,1,14,42,26,20,14,23,8,28,39,20,5,16,29],[23,36,34,48,30,12,38,2,38,23,45,31,22,30,31,27,36,40,29,8,3,25,28,50,13,28,8,31,35,28,37,24,15,12,24,35,37,34],[33,11,12,46,50,9,42,37,30,12,22,9,26,15,45,44,13,50,22,48,30,17,17,1,37,33,28,32,13,22,30,28,1,43,6,20,18,7],[42,49,48,19,23,31,24,7,29,3,21,39,49,27,50,22,24,32,30,1,35,35,29,1,33,22,45,25,41,8,50,2,27,29,2,24,26,46],[44,46,44,22,14,12,8,18,42,31,40,48,3,26,38,4,32,40,49,41,36,43,12,5,21,4,41,33,46,38,45,7,17,33,33,4,48,22],[33,8,34,10,14,28,5,22,48,35,6,32,35,19,47,10,42,26,3,7,22,21,41,30,11,50,47,40,44,4,47,16,46,43,7,10,26,16],[3,33,49,41,44,2,24,41,19,22,22,25,49,47,15,38,6,26,18,17,32,28,8,48,22,37,20,36,11,39,41,44,29,44,33,42,19,14],[22,8,14,49,30,16,17,9,33,4,22,4,17,9,48,33,13,39,28,24,9,48,46,2,31,20,12,23,7,21,16,42,22,48,26,41,16,26],[4,4,19,18,38,13,35,32,46,41,29,28,50,1,1,28,10,18,37,48,12,23,28,39,25,2,48,41,30,12,19,42,38,42,2,44,16,48],[24,25,23,18,19,22,5,27,43,29,49,49,47,28,31,7,18,22,49,7,30,22,28,5,12,24,14,10,26,39,36,26,31,6,16,21,6,35],[35,44,1,41,4,30,40,8,14,34,35,38,5,31,31,24,28,23,33,34,8,5,41,30,42,33,18,24,37,30,48,17,16,29,23,27,16,19],[7,1,39,49,38,40,12,9,30,42,35,17,5,12,17,31,7,30,11,31,10,26,48,6,28,44,43,16,31,48,36,45,35,28,10,12,42,28],[38,34,50,1,43,34,47,44,35,49,32,3,21,50,2,33,35,35,48,1,30,13,32,28,17,16,3,45,33,15,33,27,47,31,14,39,9,8],[35,19,21,10,3,36,48,17,12,5,30,20,31,28,9,22,12,34,11,26,17,7,37,12,23,40,40,23,7,19,38,31,22,40,39,41,22,42],[49,5,20,2,10,8,35,43,16,18,7,45,17,48,7,10,41,49,47,32,47,13,41,8,41,6,8,13,8,22,26,22,6,26,17,13,45,8],[8,16,44,45,46,37,4,2,14,50,8,23,30,32,48,36,3,4,50,44,19,20,4,28,6,12,14,35,24,2,48,39,33,9,36,10,13,38],[41,11,9,7,39,45,11,46,15,38,49,20,36,10,22,20,12,12,24,44,24,39,1,22,23,18,48,17,15,24,11,9,5,20,28,44,1,25],[1,40,24,5,4,33,35,27,50,32,14,2,27,7,30,49,39,29,23,43,45,20,9,49,31,30,43,37,15,27,48,49,33,12,16,31,22,6],[35,21,42,9,39,29,25,23,29,48,4,1,42,15,24,6,31,48,31,16,6,33,10,9,50,35,29,33,13,28,12,18,11,14,25,2,46,22],[36,25,45,42,3,8,19,33,19,19,28,19,4,1,1,6,27,9,5,36,14,30,4,25,39,2,2,41,46,25,8,12,28,24,25,20,13,49],[9,32,43,15,49,3,31,9,16,12,14,40,31,38,32,31,9,5,6,26,17,25,15,35,1,27,40,41,50,14,28,29,20,12,19,26,5,43],[45,28,41,6,25,41,44,49,12,24,24,26,49,18,24,30,8,50,45,11,41,27,43,17,47,22,2,13,43,5,20,46,30,49,23,8,29,24],[48,27,47,27,13,34,44,40,40,41,35,42,38,48,11,37,17,23,37,12,18,9,4,5,41,44,14,7,35,3,32,28,40,15,33,21,38,35],[34,8,26,41,33,17,11,50,50,15,1,12,45,39,26,32,7,6,4,15,23,8,42,8,22,27,3,44,20,26,41,30,12,33,42,26,20,36],[46,13,17,4,7,37,41,44,1,16,18,6,28,49,29,8,24,16,41,23,17,49,5,25,46,2,46,11,49,8,17,47,27,13,30,2,25,9],[35,36,38,8,5,2,35,43,45,20,34,3,40,6,20,6,29,47,7,23,25,40,2,37,30,10,44,35,14,35,31,8,40,21,4,19,14,1],[17,30,44,10,31,35,6,21,5,48,42,15,8,24,15,7,21,46,8,1,8,33,40,37,33,10,22,36,9,33,5,4,13,32,13,9,44,49],[16,32,28,42,21,12,16,2,12,29,20,46,26,32,22,13,27,5,46,20,28,23,30,17,13,28,13,4,50,9,2,41,18,19,25,31,12,47],[44,11,48,11,7,17,4,10,46,50,20,30,44,21,5,19,36,49,21,42,25,36,4,3,26,28,20,45,41,49,15,21,29,4,38,44,3,30]]
    target = 20
    print(Solution().minimizeTheDifference(mat, target))
    print(Solution().minimizeTheDifference2(mat, target))
    print(Solution().minimizeTheDifference3(mat, target))
    print(Solution().minimizeTheDifference4(mat, target))

